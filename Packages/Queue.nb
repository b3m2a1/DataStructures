Notebook[{Cell[CellGroupData[{Cell["Queue", "CodeSection"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"Queue", "::", "usage"}], "=", 
            "\"A simple FIFO queue\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"QueueExtend", "::", "usage"}], "=", 
            "\"Extends a Queue object\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"QueuePush", "::", "usage"}], "=", 
            "\"Pushes onto a Queue object\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"QueueEmptyQ", "::", "usage"}], "=", 
            "\"EmptyQ\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"QueueSize", "::", "usage"}], "=", 
            "\"Size of the Queue\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"QueueData", "::", "usage"}], "=", 
            "\"Queue Association\""}], ";"}]}], "CodeInput"], 
     Cell[BoxData[RowBox[{RowBox[{"Begin", "[", "\"`Private`\"", "]"}], 
         ";"}]], "InputSection"], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Queue\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Constructor\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{"Queue", "//", "ClearAll"}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"Queue", "[", 
                    "]"}], ":=", RowBox[{"Queue", "[", RowBox[{"<|", "|>"}], 
                    "]"}]}], ";"}], "\n", RowBox[{RowBox[{"unconstructedQ", 
                  "=", RowBox[{"Function", "[", RowBox[{"Null", ",", " ", 
                      RowBox[{"System`Private`EntryQ", "[", RowBox[
                         {"Unevaluated", "[", "#", "]"}], "]"}], ",", " ", 
                      "HoldFirst"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"q", ":", RowBox[{RowBox[{"Queue", "[", 
                      RowBox[{"a_Association", "?", "AssociationQ"}], "]"}], 
                    "?", "unconstructedQ"}]}], ":=", "\[IndentingNewLine]", 
                RowBox[{"System`Private`SetNoEntry", "[", RowBox[
                   {"Unevaluated", "@", "q"}], "]"}]}]}], "CodeInput"]}, 
          Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Destructor Operations\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"(*", " ", RowBox[{"basic", " ", 
                   "destructors"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{RowBox[{RowBox[{RowBox[{"QueueQ", "[", "q_Queue", 
                       "]"}], ":=", RowBox[{"System`Private`NoEntryQ", "[", 
                       "q", "]"}]}], ";"}], "\[IndentingNewLine]", 
                 RowBox[{RowBox[{RowBox[{"QueueSize", "[", RowBox[{"Queue", 
                         "[", "data_", "]"}], "]"}], ":=", RowBox[{"Length", 
                       "@", "data"}]}], ";"}], "\[IndentingNewLine]", 
                 RowBox[{RowBox[{RowBox[{"QueueData", "[", RowBox[{"Queue", 
                         "[", "data_", "]"}], "]"}], ":=", "data"}], ";"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                      {"QueueEmptyQ", "[", "q_", "]"}], ":=", RowBox[
                      {RowBox[{"QueueSize", "[", "q", "]"}], "===", "0"}]}], 
                   ";"}], "\[IndentingNewLine]", RowBox[{"(*", " ", 
                   RowBox[{"construct", " ", "all", " ", "additions", " ", 
                     "first", " ", "then", " ", "add", " ", "in", " ", 
                     "batch"}], " ", "*)"}]}]}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Push\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"QueueExtend", "[", 
                    RowBox[{RowBox[{"q", ":", RowBox[{"Queue", "[", "data_", 
                          "]"}]}], ",", " ", "dataList_"}], "]"}], ":=", 
                  "\[IndentingNewLine]", RowBox[{"Module", "[", RowBox[
                     {RowBox[{"{", RowBox[{RowBox[{"d", "=", "data"}], ",", 
                          RowBox[{"new", "=", RowBox[{RowBox[{"Range", "[", 
                          RowBox[{"Length", "@", "dataList"}], "]"}], "+", 
                          "$ModuleNumber"}]}]}], "}"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"With", "[", RowBox[
                         {RowBox[{"{", RowBox[{"j", "=", RowBox[{"Join", "[", 
                          RowBox[{"d", ",", " ", RowBox[{"AssociationThread", 
                          "[", RowBox[{"new", ",", " ", "dataList"}], 
                          "]"}]}], "]"}]}], "}"}], ",", RowBox[
                          {"System`Private`SetNoEntry", "[", RowBox[
                          {"Unevaluated", "@", RowBox[{"Queue", "[", "j", 
                          "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"QueuePush", 
                    "[", RowBox[{RowBox[{"q_Queue", "?", "QueueQ"}], ",", 
                      " ", "data_"}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{"QueueExtend", "[", RowBox[{"q", ",", " ", 
                      RowBox[{"{", "data", "}"}]}], "]"}]}], ";"}]}], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Pop\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"QueueDrop", "[", RowBox[
                     {RowBox[{"q", ":", RowBox[{"Queue", "[", "data_", 
                          "]"}]}], ",", " ", RowBox[{"n_Integer", "?", 
                        "Positive"}]}], "]"}], ":=", "\n", "  ", 
                  RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"k", "=", 
                          RowBox[{"Take", "[", RowBox[{"data", ",", " ", 
                          RowBox[{"UpTo", "@", "n"}]}], "]"}]}], "}"}], ",", 
                      "\n", "    ", RowBox[{"{", RowBox[{RowBox[{"Values", 
                          "[", "k", "]"}], ",", " ", RowBox[{"Queue", "@", 
                          RowBox[{"KeyDrop", "[", RowBox[{"data", ",", " ", 
                          RowBox[{"Keys", "[", "k", "]"}]}], "]"}]}]}], 
                        "}"}]}], "\n", "    ", "]"}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"QueuePop", "[", RowBox[{"q_Queue", 
                      "?", "QueueQ"}], "]"}], ":=", "\n", "  ", RowBox[
                   {RowBox[{RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[
                          {"[", RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], 
                          ",", " ", RowBox[{"#", "[", RowBox[{"[", "2", 
                          "]"}], "]"}]}], "}"}], "&"}], "@", RowBox[
                     {"QueueDrop", "[", RowBox[{"q", ",", " ", "1"}], 
                      "]"}]}]}], ";"}]}], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Formatting\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"Format", "[", RowBox[
                     {RowBox[{"q_Queue", "?", "QueueQ"}], ",", " ", 
                      "StandardForm"}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{"RawBoxes", "@", "\[IndentingNewLine]", RowBox[
                     {"BoxForm`ArrangeSummaryBox", "[", 
                      "\[IndentingNewLine]", RowBox[{"Queue", ",", 
                        "\[IndentingNewLine]", "q", ",", 
                        "\[IndentingNewLine]", "None", ",", 
                        "\[IndentingNewLine]", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[
                          {"BoxForm`MakeSummaryItem", "[", RowBox[{RowBox[
                          {"{", RowBox[{"\"Size:\"", ",", " ", RowBox[
                          {"QueueSize", "[", "q", "]"}]}], "}"}], ",", " ", 
                          "StandardForm"}], "]"}], "\[IndentingNewLine]", 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[{"{", 
                          "}"}], ",", "\[IndentingNewLine]", 
                        "StandardForm"}], "\[IndentingNewLine]", "]"}]}]}], 
                ";"}], "\[IndentingNewLine]", RowBox[{RowBox[{"Format", "[", 
                  RowBox[{RowBox[{"q_Queue", "?", "QueueQ"}], ",", " ", 
                    "TextForm"}], "]"}], ":=", "\[IndentingNewLine]", 
                "\"Queue[<>]\""}]}], "CodeInput"]}, Closed]]}, Open]], 
     Cell[BoxData[RowBox[{RowBox[{"End", "[", "]"}], ";"}]], 
      "InputSection"]}, Open]], Cell["", "SectionSeparator"]}, 
 WindowSize -> {808, 755}, WindowMargins -> {{316, Automatic}, 
   {Automatic, 50}}, TaggingRules -> 
  {"UUIDButtons" -> 
    {"Active" -> {"Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
       "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
       "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}}, 
 FrontEndVersion -> "12.0 for Mac OS X x86 (64-bit) (April 8, 2019)", 
 StyleDefinitions -> FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
   CharacterEncoding -> "UTF-8"]]
